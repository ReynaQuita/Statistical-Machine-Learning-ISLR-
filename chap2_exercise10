library(ISLR)
library(MASS)

?Boston

#################10b###############
pairs(Boston[,-4])
cor(Boston[,-4])


# (d)
par(mfrow=c(1,3))
hist(Boston$crim[Boston$crim>1], breaks=25)
# most cities have low crime rates, but there is a long tail: 18 suburbs appear
# to have a crime rate > 20, reaching to above 80
hist(Boston$tax, breaks=25)
# there is a large divide between suburbs with low tax rates and a peak at 660-680
hist(Boston$ptratio, breaks=25)
# a skew towards high ratios, but no particularly high ratios

# (e)
table(Boston$chas)

# (f)
media(ptratio)

# (g)
Boston[Boston$medv == min(Boston$medv), ]
Boston_percentiles = sapply(Boston[ ,-4], function(x) rank(x)/length(x))
Boston_percentiles[c(399, 406),]
#>= 90th percentile for: crim, age, lstat
#>= 75th percentile for: indus, nox, rad, tax, ptratio
#Both suburbs are chas = 0: they are not near the Charles river
#Lower percentiles for: zn, rm, dis
#black is the only variable that differs significantly, with each observation at the 88th and 35th percentiles

#(h)

sum(Boston$rm > 7)
sum(Boston$rm > 8)

Boston_gt_8rooms = Boston[Boston$rm > 8, ]
Boston_gt_8rooms_perc = Boston_percentiles[as.numeric(rownames(Boston_gt_8rooms)), ]
Boston_gt_8rooms_perc
sapply(Boston_gt_8rooms_perc, mean)
